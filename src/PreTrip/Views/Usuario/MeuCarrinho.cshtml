@model PreTrip.ViewModel.UsuariosViewModel
@using PreTrip.Session

<style>
    .pedidosCarrinhoDiv {
        width: 650px;
        height: 200px;
        background: linear-gradient(to right, #1e5799 0%,#2989d8 0%,#f2f2f2 100%);
        box-shadow: 2px 2px 2px 2px gray;
        margin-left: 25px;
    }

    .texto {
        margin-left: 200px;
        margin-top: -100px;
    }

    #finalizarCompra {
        margin-left: 500px;
        margin-top: 19px;
        position: absolute;
    }

    #cancelarCompra {
        margin-left: 332px;
        margin-top: 20px;
        position: absolute;
    }

        #finalizarCompra button, #cancelarCompra button {
            border-radius: 19px;
        }

    #precoViagem {
        margin-left: 521px;
        margin-top: -108px;
        position: absolute;
        font-size: 20px;
        color: green;
        text-shadow: 2px 2px 2px gray;
    }
</style>
<div class="container">
    <h2>MeuCarrinho</h2>

    @*Se não contém nenhum item no carrinho*@
    @if (!Model.Carrinho.Any())
    {
        <p>
            Você precisa adicionar itens no carrinho! @Html.ActionLink("Clique aqui", "Index", "Viagem") para buscar viagens!
        </p>
    }
    else
    {
        using (Html.BeginForm("ConfirmarCompra", "Usuario", FormMethod.Post))
        {
            foreach (var pedido in Model.Carrinho)
            {
                <div class="row viagem-box">
                    <a href="/Viagem/Visualizar/@pedido.ViagemId">
                        <div class="col-md-3" style="background: url(@pedido.Viagem.UrlImagem) center; background-size: cover; height: 7em;">
                        </div>
                    </a>


                    <div class="viagem-body col-md-8">
                        <a href="/Viagem/Visualizar/@pedido.ViagemId">
                            <div class="col-md-4">
                                <h3>@pedido.Viagem.Titulo</h3>
                                @*<p>@pedido.Viagem.Origem.Cidade - @pedido.Viagem.Destino.Cidade</p>*@
                            </div>

                        </a>

                        <div class="col-md-6">
                            Qtd:<br />
                            <input type="number" min="@pedido.Quantidade" value="@pedido.Quantidade" />
                        </div>

                        <div class="col-md-2">
                            R$ @pedido.Viagem.PrecoPassagem
                        </div>
                    </div>
                </div>
            }

            <hr />

            <div class="pull-right">
                <div style="font-size: 2rem; text-align: right">
                    Total: R$ @Model.PrecoTotal <br />
                    Desconto: @Model.PrecoDesconto != 0 ? Model.PrecoDesconto : "NENHUM"
                    Preço Final: R$ @Model.PrecoTotal-Model.PrecoDesconto
                </div>

                <hr />
                <div>
                    @if (PreTripSession.Usuario != null)
                    {
                        <button type="submit" class="btn btn-success">Confirmar Compra</button>
                    }
                    else
                    {
                        <span>@Html.ActionLink("Logue-se", "Index", "Home") para confirmar a compra!</span>
                    }
                </div>
            </div>
        }
    }
</div>
